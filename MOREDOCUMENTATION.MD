# YouTube Video Segment Downloader

A powerful Django-based web application that allows users to download specific segments of YouTube videos instead of entire videos. Perfect for extracting tutorials, music clips, highlights, or any portion of longer content without wasting bandwidth or storage.

![Version](https://img.shields.io/badge/version-1.0.0-blue)
![Django](https://img.shields.io/badge/Django-4.2-green)
![License](https://img.shields.io/badge/license-MIT-orange)

---

## ğŸ“‘ TABLE OF CONTENTS
1. [System Overview](#system-overview)
2. [Architecture](#architecture)
3. [Features](#features)
4. [Technology Stack](#technology-stack)
5. [Installation Guide](#installation-guide)
6. [Usage Guide](#usage-guide)
7. [API Documentation](#api-documentation)
8. [Database Schema](#database-schema)
9. [Background Processing](#background-processing)
10. [File Management](#file-management)
11. [Security](#security)
12. [Performance Optimization](#performance-optimization)
13. [Testing](#testing)
14. [Deployment](#deployment)
15. [Troubleshooting](#troubleshooting)
16. [Contributing](#contributing)
17. [License](#license)

---

## ğŸ¯ SYSTEM OVERVIEW

### What It Does
The YouTube Segment Downloader solves a common problem: **downloading only the part of a video you actually need**. Instead of downloading a 5GB course to watch a 10-minute segment, users can specify start and end times and download just that portion.

### Core Use Cases
- **Students**: Extract specific lectures from long courses
- **Content Creators**: Download raw footage segments
- **Researchers**: Capture specific moments from videos
- **Music Lovers**: Download only the song portion from a long video
- **Editors**: Get specific clips for editing projects

---

## ğŸ—ï¸ ARCHITECTURE

### High-Level Architecture Diagram
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ FRONTEND â”‚â”€â”€â”€â”€â–¶â”‚ BACKEND â”‚â”€â”€â”€â”€â–¶â”‚ EXTERNAL â”‚
â”‚ (Django â”‚ â”‚ (Django + â”‚ â”‚ SERVICES â”‚
â”‚ Templates) â”‚ â”‚ Celery) â”‚ â”‚ (YouTube) â”‚
â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ REDIS QUEUE â”‚
â”‚ (Celery) â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ WORKER POOL â”‚
â”‚ (Processors) â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE SYSTEM â”‚
â”‚ - Temp Storage â”‚
â”‚ - Download Storage â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

text

### Component Architecture

#### 1. **Frontend Layer** (Django Templates)
- **Purpose**: User interaction and real-time feedback
- **Components**: HTML5, CSS3, JavaScript, HTMX
- **Key Files**: `templates/`, `static/js/`, `static/css/`

#### 2. **API Layer** (Django REST Framework)
- **Purpose**: Handle all client-server communication
- **Endpoints**: Video info extraction, download requests, status tracking
- **Location**: `api/views.py`, `api/urls.py`

#### 3. **Business Logic Layer**
- **Purpose**: Core functionality implementation
- **Services**: YouTube extraction, validation, file management
- **Location**: `videos/services.py`, `downloads/services.py`

#### 4. **Data Layer**
- **Purpose**: Persist application data
- **Models**: VideoInfo, DownloadTask, VideoQuality
- **Location**: `videos/models.py`, `downloads/models.py`

#### 5. **Task Queue Layer**
- **Purpose**: Handle async processing
- **Technology**: Celery + Redis
- **Location**: `core/celery.py`, `downloads/tasks.py`

#### 6. **Storage Layer**
- **Purpose**: Manage temporary and permanent files
- **Structure**: `media/temp/`, `media/downloads/`
- **Cleanup**: Automated daily cleanup tasks

### Data Flow Diagram
USER ACTION SYSTEM PROCESSING OUTPUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Enter YouTube URL â”€â”€â–º Validate URL â”€â”€â–º Display
â”‚ â”‚ video info
â”‚ â–¼
â””â”€â”€â–º Extract video info via yt-dlp
â”‚
â–¼
Save to VideoInfo model
â”‚
â–¼
Return formatted data to frontend

Select timestamps â”€â”€â–º Validate timestamps â”€â”€â–º Show
& quality estimated
â”‚ size
â–¼
Create DownloadTask record
â”‚
â–¼
Queue Celery task with task_id
â”‚
â–¼
Return task_id to frontend

Monitor progress â”€â”€â–º Celery worker picks up task â”€â”€â–º Progress
â”‚ â”‚ bar
â”‚ â–¼
â”‚ Download full video to temp/
â”‚ â”‚
â”‚ â–¼
â”‚ Extract segment using ffmpeg
â”‚ â”‚
â”‚ â–¼
â”‚ Save to media/downloads/
â”‚ â”‚
â”‚ â–¼
â””â”€â”€â–º Update task status â”€â”€â–º Complete download ready
â”‚
â–¼
Trigger temp file cleanup

text

---

## âœ¨ FEATURES

### Core Features
| Feature | Description | Status |
|---------|-------------|--------|
| âœ… Video Info Extraction | Get title, duration, thumbnails, available qualities | Complete |
| âœ… Segment Selection | Specify exact start/end times with validation | Complete |
| âœ… Quality Selection | Choose from available video/audio qualities | Complete |
| âœ… Async Processing | Downloads handled in background without blocking | Complete |
| âœ… Real-time Progress | Live progress bar with percentage updates | Complete |
| âœ… File Size Estimation | Calculate expected file size before download | Complete |
| âœ… Download History | Track all previous downloads per session | Complete |
| âœ… Auto Cleanup | Temporary files removed after 24 hours | Complete |

### Advanced Features
| Feature | Description | Status |
|---------|-------------|--------|
| ğŸš€ Batch Processing | Download multiple segments at once | Planned |
| ğŸ¯ Chapter Detection | Auto-detect video chapters for quick selection | Planned |
| ğŸ“ Transcript Search | Search within video transcripts | Planned |
| ğŸ”— Shareable Links | Generate shareable download links | Planned |
| ğŸ“± PWA Support | Install as progressive web app | Planned |
| ğŸ¨ Custom Output Names | User-defined output filenames | Planned |

---

## ğŸ› ï¸ TECHNOLOGY STACK

### Backend
| Technology | Version | Purpose |
|------------|---------|---------|
| Python | 3.10+ | Core programming language |
| Django | 4.2 | Web framework |
| Django REST Framework | 3.14 | API development |
| Celery | 5.3 | Async task queue |
| Redis | 7.0 | Message broker |
| yt-dlp | 2023.10.13 | YouTube extraction |
| moviepy | 1.0.3 | Video processing |
| ffmpeg | 6.0 | Video segment extraction |

### Frontend
| Technology | Version | Purpose |
|------------|---------|---------|
| HTML5 | - | Structure |
| CSS3 | - | Styling |
| Bootstrap | 5.3 | Responsive design |
| JavaScript | ES6 | Interactivity |
| HTMX | 1.9 | Dynamic updates |
| Chart.js | 4.4 | Progress visualization |
| Font Awesome | 6.0 | Icons |

### Database
| Environment | Database |
|-------------|----------|
| Development | SQLite |
| Production | PostgreSQL |

### Infrastructure
| Component | Technology |
|-----------|------------|
| Web Server | Nginx/Gunicorn |
| Cache | Redis |
| Task Queue | Celery |
| File Storage | Local/Cloud (S3 compatible) |
| Monitoring | Prometheus/Grafana (optional) |

---

## ğŸ“¥ INSTALLATION GUIDE

### Prerequisites
- Python 3.10 or higher
- Redis Server
- ffmpeg
- Git

### Step-by-Step Installation

#### 1. Clone Repository
```bash
git clone https://github.com/yourusername/youtube-segment-downloader.git
cd youtube-segment-downloader
2. Set Up Virtual Environment
bash
# Create virtual environment
python -m venv venv

# Activate it (Windows)
venv\Scripts\activate

# Activate it (Mac/Linux)
source venv/bin/activate
3. Install Dependencies
bash
pip install -r requirements.txt
4. Install ffmpeg
bash
# Ubuntu/Debian
sudo apt update && sudo apt install ffmpeg

# MacOS
brew install ffmpeg

# Windows
# Download from https://ffmpeg.org/download.html
# Add to PATH
5. Environment Configuration
Create .env file in root directory:

env
# Django Settings
DJANGO_SECRET_KEY=your-secret-key-here-change-in-production
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Redis
REDIS_URL=redis://localhost:6379

# File Storage
MEDIA_ROOT=media/
MAX_SEGMENT_SIZE=1073741824  # 1GB
TEMP_FILE_RETENTION=86400    # 24 hours
6. Initialize Database
bash
python manage.py migrate
python manage.py createsuperuser
7. Start Services
Terminal 1 - Django Server:

bash
python manage.py runserver
Terminal 2 - Redis Server:

bash
redis-server
Terminal 3 - Celery Worker:

bash
celery -A core worker --loglevel=info
Terminal 4 - Celery Beat (optional):

bash
celery -A core beat --loglevel=info
8. Verify Installation
Visit http://localhost:8000 in your browser. You should see the application homepage.

ğŸ“– USAGE GUIDE
1. Extracting Video Information
Step 1: Paste YouTube URL into input field

text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ https://youtube.com/watch?v=abc123xyz           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Extract Info]
Step 2: View video details

text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¬ Video Title: Complete Python Course 2024    â”‚
â”‚  â±ï¸ Duration: 02:30:00                          â”‚
â”‚  ğŸ‘¤ Uploader: Tech Academy                      â”‚
â”‚                                                  â”‚
â”‚  Available Qualities:                            â”‚
â”‚  â˜‘ 1080p (MP4) - 2.5GB full                     â”‚
â”‚  â˜‘ 720p (MP4) - 1.2GB full                       â”‚
â”‚  â˜‘ 480p (MP4) - 800MB full                       â”‚
â”‚  â˜‘ Audio Only (MP3) - 150MB full                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2. Selecting a Segment
Step 1: Choose time range

text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Start Time: [01:15:30]  â”‚ End Time: [01:25:45] â”‚
â”‚                                                  â”‚
â”‚  Timeline: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘[â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“]â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
â”‚           0:00        1:15:30   1:25:45    2:30 â”‚
â”‚                                                  â”‚
â”‚  Selected Duration: 00:10:15 (615 seconds)       â”‚
â”‚  Estimated Size: 85MB (at 1080p)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Step 2: Choose quality and download

text
[â–¼ Select Quality] [Download Segment]

Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 45%
Status: Processing... (ETA: 45 seconds)
3. Monitoring Downloads
Download History Page:

text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  YOUR DOWNLOADS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ Python Course - 1080p - 01:15:30 to 01:25:45 â”‚
â”‚    Completed 2 minutes ago - [Download] [Delete] â”‚
â”‚  â³ JavaScript Tutorial - Processing (45%)        â”‚
â”‚  âŒ React Guide - Failed (Invalid timestamps)     â”‚
â”‚    [Retry]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ“¡ API DOCUMENTATION
Base URL
text
http://localhost:8000/api/
Endpoints
1. Extract Video Information
http
POST /api/extract-info/
Content-Type: application/json

{
    "youtube_url": "https://youtube.com/watch?v=abc123"
}
Success Response (200 OK)

json
{
    "youtube_id": "abc123",
    "title": "Complete Python Course",
    "duration": 9000,
    "thumbnail": "https://img.youtube.com/vi/abc123/maxresdefault.jpg",
    "uploader": "Tech Academy",
    "formats": [
        {
            "quality": "1080p",
            "format_id": "137+140",
            "ext": "mp4",
            "filesize": 2621440000,
            "has_video": true,
            "has_audio": true
        }
    ]
}
Error Response (400 Bad Request)

json
{
    "error": "Invalid YouTube URL"
}
2. Create Download Task
http
POST /api/download-segment/
Content-Type: application/json

{
    "youtube_url": "https://youtube.com/watch?v=abc123",
    "start_time": 4530,
    "end_time": 5145,
    "quality": "1080p"
}
Success Response (202 Accepted)

json
{
    "task_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "pending",
    "estimated_size": 89128960,
    "estimated_duration": 615
}
3. Check Task Status
http
GET /api/task-status/550e8400-e29b-41d4-a716-446655440000/
Processing Response (200 OK)

json
{
    "task_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "processing",
    "progress": 45,
    "download_url": null,
    "error_message": null
}
Completed Response (200 OK)

json
{
    "task_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "completed",
    "progress": 100,
    "download_url": "/media/downloads/abc123_4530_5145_1080p.mp4",
    "file_size": 89128960
}
Failed Response (200 OK)

json
{
    "task_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "failed",
    "progress": 0,
    "download_url": null,
    "error_message": "Network timeout while downloading"
}
ğŸ’¾ DATABASE SCHEMA
Entity Relationship Diagram
text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    users        â”‚       â”‚   videos_videoinfo      â”‚   downloads_downloadtask â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id              â”‚â”€â”€â”€â”€â”€â”€â”¼â”‚ video_id        â”‚       â”‚ id              â”‚
â”‚ username        â”‚       â”‚ youtube_id      â”‚â”€â”€â”€â”€â”€â”€â”¼â”‚ task_id         â”‚
â”‚ email           â”‚       â”‚ title           â”‚       â”‚ video_id        â”‚
â”‚ password        â”‚       â”‚ duration        â”‚       â”‚ start_time      â”‚
â”‚ date_joined     â”‚       â”‚ thumbnail_url   â”‚       â”‚ end_time        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ uploader        â”‚       â”‚ quality         â”‚
                          â”‚ created_at      â”‚       â”‚ status          â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ progress        â”‚
                                  â”‚                  â”‚ output_file     â”‚
                                  â”‚                  â”‚ created_at      â”‚
                                  â–¼                  â”‚ completed_at    â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ error_message   â”‚
                          â”‚videos_videoquality      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                          â”‚ id              â”‚
                          â”‚ video_id        â”‚
                          â”‚ format_note     â”‚
                          â”‚ format_id       â”‚
                          â”‚ ext             â”‚
                          â”‚ filesize        â”‚
                          â”‚ vcodec          â”‚
                          â”‚ acodec          â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Models Detailed
VideoInfo
Field	Type	Description
youtube_id	CharField(50, unique)	YouTube video identifier
title	CharField(500)	Video title
duration	IntegerField	Duration in seconds
thumbnail_url	URLField(500)	URL to thumbnail
description	TextField	Video description
uploader	CharField(200)	Channel name
upload_date	DateField	When video was uploaded
created_at	DateTimeField	When record was created
updated_at	DateTimeField	Last update timestamp
VideoQuality
Field	Type	Description
video	ForeignKey	Link to VideoInfo
format_note	CharField(100)	Quality label (1080p, 720p)
format_id	CharField(50)	yt-dlp format identifier
ext	CharField(10)	File extension
filesize	BigIntegerField	Size in bytes
vcodec	CharField(100)	Video codec
acodec	CharField(100)	Audio codec
DownloadTask
Field	Type	Description
task_id	CharField(100, unique)	UUID for tracking
user	ForeignKey	User who requested (nullable)
video	ForeignKey	Link to VideoInfo
start_time	IntegerField	Start second
end_time	IntegerField	End second
quality	CharField(50)	Requested quality
status	CharField(20)	pending/processing/completed/failed
progress	IntegerField	0-100 percentage
output_file	FileField	Path to downloaded file
file_size	BigIntegerField	Actual file size
created_at	DateTimeField	When task was created
completed_at	DateTimeField	When processing finished
error_message	TextField	Error details if failed
âš™ï¸ BACKGROUND PROCESSING
Celery Task Flow
python
# Task: process_download_segment
# Queue: downloads
# Priority: Medium

@shared_task(bind=True, max_retries=3)
def process_download_segment(self, task_id):
    """
    Background task workflow:
    1. Fetch task from database
    2. Update status to 'processing'
    3. Download full video to temp location
    4. Extract specified segment using ffmpeg
    5. Save to permanent storage
    6. Update task status to 'completed'
    7. Clean up temporary files
    """
Task States
text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PENDING â”‚â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
             â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ PROCESSING â”‚â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
             â”‚         â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”‚
      â–¼             â–¼  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPLETED â”‚ â”‚ FAILED â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Queue Management
Concurrent Tasks: 5 parallel downloads

Queue Size: Unlimited with monitoring

Task Timeout: 1 hour per segment

Retry Policy: 3 retries with exponential backoff

ğŸ“ FILE MANAGEMENT
Directory Structure
text
media/
â”œâ”€â”€ temp/
â”‚   â”œâ”€â”€ abc123_full_1080p.mp4        # Temporary full video
â”‚   â”œâ”€â”€ abc123_full_1080p.part        # Partial download
â”‚   â””â”€â”€ .gitkeep
â””â”€â”€ downloads/
    â”œâ”€â”€ abc123_120_300_1080p.mp4      # Completed segment
    â”œâ”€â”€ def456_60_120_720p.mp4
    â””â”€â”€ .gitkeep
File Naming Convention
text
{youtube_id}_{start_time}_{end_time}_{quality}.{ext}
Example: abc123_120_300_1080p.mp4
Cleanup Policy
python
@shared_task
def cleanup_old_files():
    """
    Daily cleanup task:
    - Remove temp files older than 24 hours
    - Remove download files older than 7 days
    - Log all deletions
    """
    cutoff_time = now() - timedelta(hours=24)
    old_files = TempFile.objects.filter(created_at__lt=cutoff_time)
    for file in old_files:
        os.remove(file.path)
        file.delete()
ğŸ”’ SECURITY
Implemented Measures
1. Input Validation
python
def validate_youtube_url(url):
    # Regex pattern for YouTube URLs
    pattern = r'^(https?://)?(www\.)?(youtube\.com|youtu\.be)/.+$'
    if not re.match(pattern, url):
        raise ValidationError("Invalid YouTube URL")
2. Rate Limiting
python
RATE_LIMIT = {
    'default': '100/hour',
    'authenticated': '500/hour',
    'download': '20/hour'
}
3. File Security
File type validation

Path traversal prevention

Secure file permissions (644)

Virus scanning (optional)

4. API Security
CORS configuration

CSRF protection

XSS prevention

SQL injection protection

5. Data Protection
Environment variables for secrets

Encrypted database fields

HTTPS enforcement in production

Secure session handling

âš¡ PERFORMANCE OPTIMIZATION
Caching Strategy
python
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.redis.RedisCache',
        'LOCATION': 'redis://localhost:6379/1',
        'TIMEOUT': 3600,  # 1 hour
    }
}

# Cache video info for 24 hours
@cache_page(60 * 60 * 24)
def get_video_info(request):
    # Implementation
    pass
Database Optimization
Indexed fields: youtube_id, task_id, status

Pagination for large result sets

Query optimization with select_related and prefetch_related

Connection pooling

File Serving
nginx
# Nginx configuration for efficient file serving
location /media/ {
    alias /path/to/media/;
    expires 30d;
    add_header Cache-Control "public, no-transform";
}
ğŸ§ª TESTING
Test Structure
text
tests/
â”œâ”€â”€ test_models.py
â”œâ”€â”€ test_views.py
â”œâ”€â”€ test_api.py
â”œâ”€â”€ test_services.py
â”œâ”€â”€ test_tasks.py
â””â”€â”€ test_validators.py
Sample Tests
python
class VideoExtractionTests(TestCase):
    def test_valid_youtube_url(self):
        url = "https://youtube.com/watch?v=abc123"
        result = validate_youtube_url(url)
        self.assertTrue(result)
    
    def test_invalid_timestamps(self):
        with self.assertRaises(ValidationError):
            validate_timestamps(100, 50, 200)
    
    def test_download_task_creation(self):
        task = create_download_task(
            url="https://youtube.com/watch?v=abc123",
            start=120,
            end=300,
            quality="720p"
        )
        self.assertIsNotNone(task.task_id)
        self.assertEqual(task.status, 'pending')
Run Tests
bash
# Run all tests
python manage.py test

# Run specific test file
python manage.py test tests.test_models

# Run with coverage
coverage run manage.py test
coverage report
ğŸš€ DEPLOYMENT
Docker Deployment
Dockerfile:

dockerfile
FROM python:3.10-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    ffmpeg \
    redis-server \
    && rm -rf /var/lib/apt/lists/*

# Install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy project
COPY . .

# Run gunicorn
CMD ["gunicorn", "--bind", "0.0.0.0:8000", "core.wsgi:application"]
docker-compose.yml:

yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DEBUG=False
      - DB_HOST=db
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=youtube_downloader
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=securepassword
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine

  celery:
    build: .
    command: celery -A core worker --loglevel=info
    environment:
      - REDIS_URL=redis://redis:6379
    depends_on:
      - redis
      - web

volumes:
  postgres_data:
Production Checklist
Set DEBUG=False

Use PostgreSQL instead of SQLite

Configure proper logging

Set up SSL certificate

Configure CDN for file serving

Set up monitoring (Prometheus/Grafana)

Configure backup strategy

Set up error tracking (Sentry)

Configure firewall rules

Set up automated deployments

ğŸ”§ TROUBLESHOOTING
Common Issues and Solutions
1. Redis Connection Error
text
Error: Could not connect to Redis at 127.0.0.1:6379
Solution:

bash
# Start Redis server
redis-server

# Check if Redis is running
redis-cli ping
# Should return: PONG
2. ffmpeg Not Found
text
Error: FFMPEG not found in system PATH
Solution:

bash
# Install ffmpeg
# Verify installation
ffmpeg -version
3. Download Task Stuck at "Processing"
Solution:

bash
# Restart Celery worker
pkill -f celery
celery -A core worker --loglevel=info

# Check Celery logs
tail -f logs/celery.log
4. File Permission Errors
Solution:

bash
# Fix media directory permissions
chmod -R 755 media/
chown -R www-data:www-data media/
5. Memory Issues with Large Videos
Solution:

Reduce MAX_SEGMENT_SIZE in settings

Implement chunked downloading

Increase server memory

ğŸ¤ CONTRIBUTING
Development Workflow
Fork the repository

Create feature branch (git checkout -b feature/amazing-feature)

Commit changes (git commit -m 'Add amazing feature')

Push to branch (git push origin feature/amazing-feature)

Open Pull Request

Code Style
Follow PEP 8 for Python

Use Black formatter

Write docstrings for all functions

Add type hints

Pull Request Checklist
Tests pass

Code formatted

Documentation updated

No merge conflicts

PR description explains changes

ğŸ“„ LICENSE
MIT License

Copyright (c) 2024 [Your Name/Organization]

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

ğŸ“ SUPPORT
Contact
Issues: GitHub Issues

Email: support@example.com

Discord: Join our server

Documentation
API Docs: /api/docs/ (when server running)

Wiki: GitHub Wiki

Tutorials: Coming soon

ğŸ™ ACKNOWLEDGMENTS
yt-dlp for YouTube extraction

Django for the web framework

Celery for async processing

FFmpeg for video manipulation

All contributors and users

Made with â¤ï¸ for educators and students everywhere

text

This comprehensive README provides:

1. **Complete System Overview** - What it does and why
2. **Detailed Architecture** - How all components interact
3. **Full Installation Guide** - Step-by-step setup
4. **Usage Documentation** - How users interact with the system
5. **API Reference** - All endpoints with examples
6. **Database Schema** - Complete data structure
7. **Background Processing** - How Celery handles tasks
8. **Security Measures** - All protection implemented
9. **Performance Optimization** - How it's tuned for speed
10. **Testing Strategy** - How to ensure quality
11. **Deployment Guide** - Production setup
12. **Troubleshooting** - Common issues and solutions
13. **Contributing Guidelines** - For open source collaboration

The README serves as both documentation for users and a technical reference for developers working on the project.
